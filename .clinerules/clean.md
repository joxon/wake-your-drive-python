# Skill: Clean WakeTheDrive Build Artifacts

This skill teaches you how to remove all local build artifacts produced by the WakeTheDrive build scripts.

## Overview

Build artifacts accumulate in several locations:

| Location | Contents |
|---|---|
| `bin/dist/` | Final distributables: `WakeTheDrive_Mac`, `WakeTheDrive_Mac.app`, `WakeTheDrive_Linux`, `WakeTheDrive.exe` |
| `bin/build/` | PyInstaller work directory (intermediate object files, `.toc`, `.pkg`, etc.) |
| `bin/*.spec` | PyInstaller spec files auto-generated during a build |
| `bin/venv/` | Python virtual environment created by the build scripts |
| `build/` | Project-root-level scratch space (gitignored) |
| `src/__pycache__/` | Python bytecode cache for the source package |
| `src/*.pyc` | Compiled Python files (if any stray outside `__pycache__`) |

## Clean Commands

### Full clean (all artifacts)

```bash
# Remove PyInstaller output and work directories inside bin/
rm -rf bin/dist bin/build bin/*.spec

# Remove the build venv (forces a fresh install on next build)
rm -rf bin/venv

# Remove project-root build scratch space
rm -rf build

# Remove Python bytecode caches
find src -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
find src -name "*.pyc" -delete 2>/dev/null || true
```

### Distributables only (keep venv for faster rebuilds)

```bash
rm -rf bin/dist bin/build bin/*.spec build
find src -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
```

### Bytecode cache only

```bash
find src -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true
find src -name "*.pyc" -delete 2>/dev/null || true
```

## Executing a Clean (Step-by-Step)

1. Confirm you are in the project root (the directory containing `src/` and `bin/`).
2. Decide which clean level is needed:
   - **Full clean** — use before a release build or when switching platforms.
   - **Distributables only** — use to re-run a build without re-creating the venv.
   - **Bytecode only** — use after moving files around or refactoring imports.
3. Run the appropriate commands above.
4. Verify the target directories are gone:
   ```bash
   ls bin/dist bin/build bin/venv build 2>&1
   # Expected output: "No such file or directory" for each path that was removed
   ```
5. Report which directories were removed and confirm the workspace is clean.

## Verification

After cleaning, confirm there are no leftover artifacts:

```bash
# Should print nothing (no dist/build/spec/venv artifacts remain)
ls bin/dist bin/build bin/*.spec bin/venv 2>/dev/null && echo "WARNING: artifacts remain" || echo "Clean OK"
```

## Common Failures & Fixes

| Symptom | Cause | Fix |
|---|---|---|
| `rm: bin/dist: No such file or directory` | Already clean or never built | Safe to ignore — artifacts were not present |
| `Permission denied` removing `bin/venv` | Running process using the venv | Stop any active build/run; then retry |
| `find: src: No such file or directory` | Running from inside `bin/` or `src/` | `cd` to the project root and re-run |
| Artifacts reappear immediately | Another build is running in parallel | Stop the parallel build first |

## Notes

- `bin/venv/`, `bin/build/`, `bin/dist/`, and `build/` are all listed in `.gitignore` — removing them will not affect version control.
- Removing `bin/venv/` will cause the next build to re-install all pip dependencies, which requires internet access. Omit this step if you want faster incremental rebuilds.
- `*.spec` files inside `bin/` are auto-generated by PyInstaller and are safe to delete; they will be recreated on the next build.
- To rebuild immediately after cleaning, see `.clinerules/build.md`.
